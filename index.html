<!--
/*
 * @author Wan Zulsarhan
 * Developed for Infomina
 */
-->

<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <base href="/" />
        <!--       
                <link rel="icon" href="https://.com/-fair/wp-content/uploads/2017/04/cropped-icon-32x32.png" sizes="32x32"/>
                <link rel="icon" href="https://.com/-fair/wp-content/uploads/2017/04/cropped-icon-192x192.png" sizes="192x192"/>
                <link rel="apple-touch-icon-precomposed" href="https://.com/-fair/wp-content/uploads/2017/04/cropped-icon-180x180.png"/>
                <meta name="msapplication-TileImage" content="https://.com/-fair/wp-content/uploads/2017/04/cropped-icon-270x270.png"/>
        -->     
        <script src="/e-jpn/js/jquery.min.js" type="text/javascript"></script>
        <meta name="description" content="This Is eJPN site" />
        <title>eJPN</title>
        <script>
            $ = jQuery;
            // Define Global Variable
            var SITE_ROOT = "e-jpn";

            var JS_VER = "123";
            var CSS_VER = "123";

            var cssToLoad = [SITE_ROOT + "/css/fontawesome-all.min.css"
                        , SITE_ROOT + "/css/app.css"
                        , SITE_ROOT + "/css/loading.css"
                        , SITE_ROOT + "/css/left-bar.css"];

            var jsToLoad = [SITE_ROOT + "/js/include-html.js"];
            
        </script>
    </head>

    <body class="jpn-main">
        <div id="app-loading" class="app-loading">
            <div>
                <img id="app-loading-img" src="" alt="" hidden />
            </div>
        </div>
        <div data-file="/component/header.html" class="include-html"></div>
        <div class="jpn-bar-content">
            <div data-file="/component/left-bar.html" class="include-html"></div>
            <div data-file="/component/content.html" class="include-html"></div>
        </div>
        <div data-file="/component/footer.html" class="include-html"></div>

        <script>
            function MainLoadAsset(js_version, css_version) {
                //console.log("Start Load Asset");
                //console.log(window.location.host);

                // init dom
                var body = document.getElementsByTagName("body")[0];
                var head = document.getElementsByTagName("head")[0];
                var app_load = document.getElementById('app-loading');
                var app_load_img = document.getElementById('app-loading-img');
                // load loading image
                app_load_img.src = SITE_ROOT + "/asset/image/loader.gif";

                // load css -------------------------------------------------------------------------
                cssToLoad.map(function (d, i) {
                    var callback = null;
                    if (i === 0) {
                        // once loading css finish show the loader gif
                        callback = function () {
                            app_load_img.removeAttribute("hidden");
                        };
                    }
                    loadAsset("css", d, callback);
                });
                // load Javascript -------------------------------------------------------------------------
                var jsLoaded = 0;
                jsToLoad.map(function (d, i) {
                    loadAsset("js", d, function () {
                        jsLoaded++;
                        if (jsLoaded >= jsToLoad.length) {
                            // hide the loading
                            app_load.style["opacity"] = "0";
                            app_load_img.style["opacity"] = "0";
                            setTimeout(function () {
                                app_load.style["display"] = "none";
                            }, 500);
                        }
                    });
                });

                //show loading until the main bundle finish load
                function loadAsset(type, url, callback) {
                    var asset = null;
                    if (type === 'js') {
                        asset = document.createElement("script");
                        asset.type = "text/javascript";
                    } else if (type === 'css') {
                        asset = document.createElement("link");
                        asset.rel = "stylesheet";
                    }

                    if (asset.readyState) {  //IE
                        asset.onreadystatechange = function () {
                            if (asset.readyState === "loaded" || asset.readyState === "complete") {
                                asset.onreadystatechange = null;
                                if (callback !== null) {
                                    callback();
                                }
                            }
                        };
                    } else {  //Others
                        asset.onload = function () {
                            if (callback !== null) {
                                callback();
                            }
                        };
                    }

                    if (type === 'js') {
                        asset.src = url + "?v=" + js_version;
                        head.appendChild(asset);

                    } else if (type === 'css') {
                        asset.href = url + "?v=" + css_version;
                        head.appendChild(asset);
                    }
                }
            }
            MainLoadAsset(JS_VER, CSS_VER);
        </script>
    </body>
</html>